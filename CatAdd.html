<!DOCTYPE html>

<html>
<head>
    <title>Add a Category Demonstration</title>
    <script>
function CreateCat()
{
    var objajax = new XMLHttpRequest();
    var url = "http://bus-pluto.ad.uab.edu/jsonwebservice/service1.svc/CreateCategory";
    //customer data from web page
    var cname = document.getElementById("catname").value;
    var cdescription = document.getElementById("catdesc").value;
    
    //Create parameter string
    var newcustomer = '{"CName":"' + cname + '","CDescription":"' + cdescription + '"}';
    var objdisplay = document.getElementById("result");
    
    //Checking for AJAX operation return
    objajax.onreadystatechange = function()
    {
        if (objajax.readyState == 4 && objajax.status == 200)
        {
            var result = JSON.parse(objajax.responseText);
            var outcome = result.WasSuccessful
            var error = result.Exception;
            OperationResult(outcome, error, objdisplay);
        }
    }
    //Start AJAX operation
    objajax.open("POST", url, true);
    objajax.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    objajax.send(newcustomer);
}

function OperationResult(success, exception, displayObject)
{
    switch (success)
    {
        case 1:
            displayObject.innerHTML = "The operation was successful!";
            break;
        case 0:
            displayObject.innerHTML = "The operation was not successful:<br>" + exception;
            break;
        case -2:
            displayObject.innerHTML = "The operation was not successful because the data string supplied could not be deserialized into the service object.";
            break;
        case -3:
            displayObject.innerHTML = "The operation was not successful because a record with the supplied Order ID could not be found";
            break;
        default:
            alert("The operation code returned is not identifiable.");
    }
}        
    </script>
</head>

<body>
        <h3>Add a Category</h3>
        <br>
        <table><tr><th>New Category Data</th></tr>
        <tr><td class="caption">Please enter the Category Name:</td>
        <td><input type="text" id="catname"></td>
        <tr>
        <td class="caption">Please enter the Category Description: </td>
        <td><input type="text" id="catdesc"></td>
        </tr>
        <tr>
        <td><button onclick="CreateCat()">Add a New Category</button></td>
        </tr>
        </table>    
        <label id="result">The result will display here.</label>
    </section>


</body>
</html>
